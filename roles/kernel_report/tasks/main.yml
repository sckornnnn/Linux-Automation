
- name: Get Kernel Version
  command: uname -r
  register: kernel_version_output

- name: Set Facts
  set_fact:
    kernel_version: "{{ kernel_version_output.stdout }}"
    ansible_dist: "{{ ansible_distribution }}"
    hostname: "{{ ansible_hostname }}"
    version: "{{ ansible_distribution_version }}"

- name: Debug Kernel Version
  debug:
    msg: "{{ inventory_hostname }} {{ansible_dist }}  {{ kernel_version }} {{ hostname }} {{ version }}"

- name: create HTML report
  template:
    src: report.j2
    dest: kernel_report.html
#    dest: /home/{{ ansible_ssh_user }}/kernel_report.html
  delegate_to: localhost
  run_once: true
  become: no

- name: Store file 
  ansible.builtin.fetch:
    src: kernel_report.html
    dest: /tmp/
  delegate_to: localhost
  run_once: true
  become: no
